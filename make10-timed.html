<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ãƒ¡ã‚¤ã‚¯10 - é€£ç¶šãƒãƒ£ãƒ¬ãƒ³ã‚¸ï¼ˆå®Œå…¨ç‰ˆï¼‰</title>
<style>
  body { font-family: "Comic Sans MS", sans-serif; text-align:center; margin:0;
         background: linear-gradient(135deg,#fff8e1,#ffecb3); }
  h1 { background:#ffb300; color:#fff; padding:15px; margin:0; }
  #hud { display:flex; justify-content:space-around; background:#ffe082; padding:10px; font-weight:bold; }
  #instruction { margin:15px; font-size:1.3rem; color:#6d4c41; }
  #game { display:flex; flex-wrap:wrap; justify-content:center; gap:10px; max-width:600px; margin:0 auto; }
  .num {
    width:70px; height:70px; background:#fff176; border-radius:50%;
    display:flex; align-items:center; justify-content:center; font-size:1.6rem; font-weight:bold;
    cursor:pointer; box-shadow:0 3px 5px rgba(0,0,0,0.2); user-select:none;
    transition: transform 0.15s, background 0.2s, color 0.2s;
  }
  .num:active { transform: scale(0.98); }
  .num:hover { transform: scale(1.06); }
  .correct { background:#81c784 !important; color:white; }
  .wrong { background:#e57373 !important; color:white; }
  #message { margin-top:15px; font-size:1.2rem; min-height:1.4rem; }
  @media (max-width:420px) {
    .num { width:60px; height:60px; font-size:1.4rem; }
  }
</style>
</head>
<body>
  <h1>â¶ ãƒ¡ã‚¤ã‚¯10</h1>

  <div id="hud">
    <div id="timer">æ®‹ã‚Šæ™‚é–“: 60s</div>
    <div id="score">ã‚¹ã‚³ã‚¢: 0</div>
    <div id="combo">ã‚³ãƒ³ãƒœ: 0</div>
  </div>

  <div id="instruction">åˆè¨ˆ10ã«ãªã‚‹ãƒšã‚¢ã‚’ã™ã¹ã¦è¦‹ã¤ã‘ã‚ˆã†ï¼</div>
  <div id="game"></div>
  <div id="message"></div>

<script>
(() => {
  const game = document.getElementById("game");
  const timerDisplay = document.getElementById("timer");
  const scoreDisplay = document.getElementById("score");
  const comboDisplay = document.getElementById("combo");
  const message = document.getElementById("message");

  let firstTile = null;
  let score = 0;
  let combo = 0;
  let timeLeft = 60;
  let timer = null;

  const basePairs = [
    [1,9],[2,8],[3,7],[4,6],[5,5],[9,1],[8,2],[7,3],[6,4]
  ];

  function startGame() {
    score = 0;
    combo = 0;
    timeLeft = 60;
    scoreDisplay.textContent = "ã‚¹ã‚³ã‚¢: 0";
    comboDisplay.textContent = "ã‚³ãƒ³ãƒœ: 0";
    message.textContent = "";
    generateNumbers();
    startTimer();
  }

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  function generateNumbers() {
    game.innerHTML = "";
    const pairs = shuffle([...basePairs]).slice(0, 6);
    let numbers = pairs.flat();

    // ä½™ç™½ã‚’ãƒ©ãƒ³ãƒ€ãƒ æ•°å­—ã§åŸ‹ã‚ã‚‹
    while (numbers.length < 20) {
      numbers.push(Math.floor(Math.random() * 9) + 1);
    }
    numbers = shuffle(numbers);

    numbers.forEach(n => {
      const div = document.createElement("div");
      div.className = "num";
      div.textContent = n;
      div.addEventListener("click", () => handleClick(div), {passive:false});
      game.appendChild(div);
    });
  }

  function handleClick(tile) {
    if (tile.classList.contains("correct")) return;
    if (!firstTile) {
      firstTile = tile;
      tile.style.border = "3px solid #000";
      return;
    }
    if (firstTile === tile) {
      firstTile.style.border = "";
      firstTile = null;
      return;
    }

    const ft = firstTile;
    const tt = tile;
    const a = parseInt(ft.textContent, 10);
    const b = parseInt(tt.textContent, 10);

    if (a + b === 10) {
      ft.classList.add("correct");
      tt.classList.add("correct");
      score += 10;
      combo += 1;
      showMessage("ğŸ¯ ãƒŠã‚¤ã‚¹ï¼");

      setTimeout(() => {
        ft.style.visibility = "hidden";
        tt.style.visibility = "hidden";
      }, 200);

      // å…¨ã¦ã®ãƒšã‚¢ã‚’è¦‹ã¤ã‘ãŸã‹ãƒã‚§ãƒƒã‚¯
      setTimeout(() => {
        if (!hasPairRemaining()) {
          showMessage("ğŸ†• æ¬¡ã®å•é¡Œï¼");
          setTimeout(() => generateNumbers(), 800);
        }
      }, 400);
    } else {
      ft.classList.add("wrong");
      tt.classList.add("wrong");
      score -= 5;
      combo = 0;
      showMessage("âŒ ã¡ãŒã†ã‚ˆï¼");
      setTimeout(() => {
        ft.classList.remove("wrong");
        tt.classList.remove("wrong");
      }, 300);
    }

    ft.style.border = "";
    firstTile = null;
    scoreDisplay.textContent = `ã‚¹ã‚³ã‚¢: ${score}`;
    comboDisplay.textContent = `ã‚³ãƒ³ãƒœ: ${combo}`;
  }

  function hasPairRemaining() {
    // è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹æ•°å­—ã®ä¸­ã«10ã«ãªã‚‹ãƒšã‚¢ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
    const visibleTiles = Array.from(document.querySelectorAll(".num"))
      .filter(el => el.style.visibility !== "hidden");
    const nums = visibleTiles.map(el => parseInt(el.textContent, 10));
    for (let i = 0; i < nums.length; i++) {
      for (let j = i + 1; j < nums.length; j++) {
        if (nums[i] + nums[j] === 10) return true;
      }
    }
    return false;
  }

  function showMessage(text) {
    message.textContent = text;
  }

  function startTimer() {
    clearInterval(timer);
    timer = setInterval(() => {
      timeLeft--;
      timerDisplay.textContent = `æ®‹ã‚Šæ™‚é–“: ${timeLeft}s`;
      if (timeLeft <= 0) {
        clearInterval(timer);
        showMessage(`â° ã‚¿ã‚¤ãƒ ã‚¢ãƒƒãƒ—ï¼æœ€çµ‚ã‚¹ã‚³ã‚¢ï¼š${score}`);
        Array.from(document.querySelectorAll(".num")).forEach(el => el.style.pointerEvents = "none");
      }
    }, 1000);
  }

  startGame();
})();
</script>
</body>
</html>
